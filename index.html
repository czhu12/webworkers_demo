<!--http://162.248.167.144:4000/-->

<html>
  <head>
    <title>Gracefully Degrading Web Workers</title>
  </head>
  <script src='http://code.jquery.com/jquery-2.1.1.min.js'></script>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js'></script>

  <body>

    <button id="start">
      Start Web Workers
    </button>
    <button id="stop">
      Stop Web Workers
    </button>
    <h4>Console</h4>
    <div id="console">
    </div>

  </body>

  <script>
    console.log = function(s){
      $("#console").append("<div>" + s + "</div>");
    }
    var numWorkers = 3;
    var workers = [];
    var startButton = document.getElementById("start");
    var stopButton = document.getElementById("stop");

    for(var i=0; i < numWorkers; i++){
      workers.push(new Worker('work.js'));
    }
    _.each(workers, function(worker){
      worker.addEventListener('message', function(e){
        console.log(e.data);
      }, false);
    });

    startButton.onclick = function(){
      _.each(workers, function(worker, i){
        worker.postMessage({command:'start', id:i});
      });
    }
    stopButton.onclick = function(){
      _.each(workers, function(worker){
        worker.postMessage({command:'start'});
      });
    }

  </script>
 
</html>
